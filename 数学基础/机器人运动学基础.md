# 机器人运动学基础

## 1、空间坐标描述：

- ### 位姿： 

  - 一个确定的空间直角坐标系**A**，则A中P的**位置**：

  $$
  ^AP=
  \begin{bmatrix}
  x\\
  y\\
  z
  \end{bmatrix}
  $$

  - P的位置矢量：

  $$
  ^AP=
  \begin{bmatrix}
  ^xP\\
  ^yP\\
  ^zP
  \end{bmatrix}
  =
  \begin{bmatrix}
  ^xP\ \ \ ^yP\ \ \ ^zP
  \end{bmatrix}^T
  $$

  - **旋转矩阵：**

    - 坐标系P的x、y、z轴与坐标系A的x、y、z轴的余弦值，即单位向量乘积
      $$
      ^A_PR=
      \begin{bmatrix}
      ^Ax_P\ \ \ ^Ay_P\ \ \ ^Az_P
      \end{bmatrix}
      =
      \begin{bmatrix}
      r_{11}\ \ \ r_{12}\ \ \ r_{13}\\
      r_{21}\ \ \ r_{22}\ \ \ r_{23}\\
      r_{31}\ \ \ r_{32}\ \ \ r_{33}\\
      \end{bmatrix}
      =
      \begin{bmatrix}
      P_xA_x\ \ \ P_xA_y\ \ \ P_xA_z\\
      P_yA_x\ \ \ P_yA_y\ \ \ P_yA_z\\
      P_zA_x\ \ \ P_zA_y\ \ \ P_zA_z\\
      \end{bmatrix}
      $$
      易得：
      $$
      ^A_PR^T=^P_AR=^A_PR^{-1}
      $$

      - 当两个坐标系的姿态无变化时，R为单位矩阵

  - **位姿=位置+姿态=位置矩阵+旋转矩阵=[ R | P ] ：**
    $$
    B=
    \begin{bmatrix}
    ^A_BR\ \ \ ^AP_{B_O}
    \end{bmatrix}
    \\^AP_{B_O} 表示两坐标系原点之间的位置矢量
    $$
    

- ### 坐标变换

  - **坐标变换方程：**
    $$
    ^A_CP&=&^A_BP+^B_CP\\
    ^B_PR&=&^B_CR\ ·\ ^C_PR
    $$

    $$
    重要方程1：\ \ R(x,\theta)= 
    \begin{bmatrix} 
    1 & 0 & 0\\
    0 & {cos\theta} & -sin\theta \\
    0&{sin\theta} & cos\theta 
    \end{bmatrix}
    $$

    $$
    重要方程2：\ \ R(y,\theta)= 
    \begin{bmatrix} 
    cos\theta & 0 & {sin\theta}\\
    0 &1 &0\\
    {-sin\theta} & 0 &cos\theta \
    
    \end{bmatrix}
    $$

    $$
    重要方程3：\ \ R(z,\theta)= 
    \begin{bmatrix} 
     {cos\theta} & -sin\theta & 0 \\
    {sin\theta} & cos\theta & 0\\
    0 & 0 & 1\\
    \end{bmatrix}
    $$

## 				

## 2、姿态的多种表示：

- ### 旋转矩阵

- ### 欧拉角：

  - 绕三轴旋转的角度，不同旋转顺序效果不同，有12种排列组合

  - 两种参考坐标系：
    - 参考固定坐标系，即：固定旋转轴的欧拉角
    - 参考自身坐标系，即：非固定旋转轴的欧拉角

  - 故一共有：12 x 2 = 24 种旋转方式

$$
如参考原本的固定坐标系，以X轴、Y轴、Z轴顺序旋转：\ \ R_{XYZ}(\gamma,\beta,\alpha) = R_Z(\alpha)\ R_Y(\beta)\ R_X(\gamma)
$$

$$
如参考自身坐标系，则可以分解旋转：^A_BR = ^{A}_{B'}R·^{B’}_{B''}R·^{B’''}_{B}R
$$

- ### 轴角：

  - 两个坐标系之间的任何姿态都可以通过绕某一个特定的轴(矢量)旋转特定的角度得到。

  - $$
    \begin{flalign}
    &假设坐标系B和参考坐标系A重合\\
    &将B绕着A坐标系下的矢量^AK按右手定则旋转\theta角度\\
    &旋转之后B坐标系在A坐标系下的姿态表示为：\\\\
    &\ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ^A_BR(K,\theta)\\\\
    &由于矢量K为单位矢量(模长为1)，K为一个3*1的矢量 \\
    &\ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 则有：^AK=
    \begin{bmatrix}
    k_x\ \ \ k_y\ \ \ k_z
    \end{bmatrix}^T
    \end{flalign}
    $$

- ### 四元数：

  - 四维超球的投影

## 3、齐次坐标变换：

- $$
  ^A_BT=
  \begin{bmatrix}
  &R&P\ \ \\
  &0&1\ \ 
  \end{bmatrix}
  =
  \begin{bmatrix}
  &r_{11}&r_{12}&r_{13}&x\ \ \\
  &r_{21}&r_{22}&r_{23}&y\ \ \\
  &r_{31}&r_{32}&r_{33}&z\ \ \\
  &0&0&0&1\ \ 
  \end{bmatrix}\\
  左下角是目标坐标系，左上角是参考坐标系，这里表示B坐标系到A坐标系的变换关系
  $$

- 平移和旋转的复合变换，可以直接用齐次变换矩阵代替

- 齐次矩阵的逆
  $$
  ^A_BT^{-1}=^B_AT\\
  表示反方向的变换
  $$

- 齐次矩阵的乘法：

  - 与平移向量相乘：求出该向量在另一坐标系下的表示

  - 与齐次矩阵相乘：表示不同坐标系的转换关系
    $$
    ^A_BT\ ^B_CT\ ^C_DT=^A_DT
    $$
    

## 4、Python实现

```python
import numpy as np
#创建3x3的单位矩阵
a = np.identity(3)
#创建3x3的零矩阵
b = np.zeros([3,3])
#创建3x3的随机矩阵
c = np.random.rand(3,3)
#从已有数组创建2x2矩阵
d = np.asarray([1,2,3,4]).reshape(2,2)

#判断矩阵是否相等,返回值为True或False
np.allclose(a,b) 
#矩阵加减法
e = np.add(a,b)
f = np.subtract(a,b)
#矩阵乘法
g = np.dot(a,b)
#矩阵求逆
h = np.linalg.inv(a)
#矩阵转置
i = a.T
```

